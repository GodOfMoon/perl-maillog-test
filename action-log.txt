Продумал архитектуру приложения, решил, что будет 6-7 файлов.

Нашел простой http сервер, решил применить его, вместо cgi, который знал до этого.

Ссылка https://metacpan.org/pod/HTTP::Server::Simple

Установка:
$ cpanm HTTP::Server::Simple

Далее реализовал отображение html страницы и запросов json данных.
Для удобства использовал модуль JSON

Установка:
$ cpanm JSON

Далее использовал наработки для создания пакета core.pm

Для доступа к БД так же установил пакет DBI

Установка:
$ cpanm DBI

Попробовал из bash скрипта экспортнуть переменные окружения, оставил эту идею, ограничился командой:
$ source conf.cfg

Потратил 3 часа на поиск ошибки, почему пользователь не подключается к БД... Ошибка была здесь:
mysql> CREATE USER IF NOT EXISTS 'perl_mail_log_parser_db_user'@'local_host' IDENTIFIED BY 'perl_mail_log_parser_db_password';
а надо было
mysql> CREATE USER IF NOT EXISTS 'perl_mail_log_parser_db_user'@'localhost' IDENTIFIED BY 'perl_mail_log_parser_db_password';

Дальше около 2х часов писал парсер

В базу всё добавил, столкнулся с тем, что переменные окружения во время запуска сервера не подтягиваются.

Решил это добавлением флага -E к sudo при запуске

================================
================================

Итого:

Для запуска приложения должен быть предустановлен mysql-server

# apt install mysql-server

Далее необходимо проинициализировать БД, пользователя, таблицы (init.sql)
# mysql -u root -p
mysql> ...

Добавить переменные окружения

$ source conf.cfg

Установить сопровождающие пакеты (я ставил через sudo т.к не хотел долго думать над тем, как правильно perllib путь указать)
# cpanm HTTP::Server::Simple
# cpanm JSON
# cpanm DBI

Так же я дополнительно ставил libdbd-mysql-perl

# apt install libdbd-mysql-perl

Запустить скрипт по наполнению БД
$ ./scripts/maillog_parser.pl

Далее запустить сервер:

sudo -E ./index.cgi

Так же для полноты проекта можно было бы всё засунуть в докер, добавить обработку входных данных (на поле email), но,
думаю, вы смотрите именно на навыки в perl.
Признаюсь честно, не писал год на perl'е мозг скрипел, но, многие нюансы были благополучно вынуты из задворок памяти.

Что-то еще хотел добавить, но вылетело из головы.

Желаю всем прекрасного дня!



P.S.
Вы просили агрегировать данные из двух таблиц, для этого я бы сразу сделал условный union, но в одной из таблиц
отсутствует поле address, что вызывает противоречие с изначально заданной структурой таблиц.
Пошел по пути наименьшего сопротивления и не стал добавлять это поле в БД, по-хорошему, нужно было уточнить, как следует
действовать.







